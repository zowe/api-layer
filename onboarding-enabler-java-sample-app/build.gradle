buildscript {
    repositories {
        mavenCentral()
        gradlePluginPortal()
    }
    dependencies {
        classpath 'com.bmuschko:gradle-tomcat-plugin:2.7.0'
    }
}

apply plugin: 'java'
apply plugin: 'war'
apply plugin: 'com.bmuschko.tomcat'

repositories {
    mavenCentral()
}

dependencies {
    api(project(':onboarding-enabler-java'))

    implementation 'io.swagger.core.v3:swagger-jaxrs2:2.0.0'

    compileOnly libraries.javax_servlet_api
    implementation(libraries.jackson_dataformat_yaml) {
        exclude group: "org.yaml", module: "snakeyaml"
    }
    implementation libraries.snakeyaml

    compileOnly libraries.lombok
    annotationProcessor libraries.lombok

    implementation libraries.jersey_server
    implementation libraries.jersey_hk2
    implementation libraries.jersey_container_servlet_core
    implementation libraries.jersey_media_json_jackson

    testImplementation libraries.jersey_test_provider_jdk_http
    testImplementation libraries.spring4Test
    testImplementation libraries.mockito_core
    testImplementation libraries.json_path
// https://mvnrepository.com/artifact/junit/junit
    testImplementation group: 'junit', name: 'junit', version: '4.13.2'
    def tomcatVersion = '9.0.68'
    tomcat "org.apache.tomcat.embed:tomcat-embed-core:${tomcatVersion}",
        "org.apache.tomcat.embed:tomcat-embed-logging-juli:9.0.0.M6",
        "org.apache.tomcat.embed:tomcat-embed-jasper:${tomcatVersion}"
}

tomcat {
    httpsPort = 10016
    ajpPort = 8009
    stopPort = 8081
    contextPath = '/'
    enableSSL = true
    tomcatRun.keystoreFile = file("${project.rootDir}/keystore/localhost/localhost.keystore.p12")
    tomcatRun.truststoreFile = file("${project.rootDir}/keystore/localhost/localhost.truststore.p12")
    tomcatRun.keystorePass = "password"
    tomcatRun.truststorePass = "password"
    httpProtocol = 'org.apache.coyote.http11.Http11Nio2Protocol'
    ajpProtocol  = 'org.apache.coyote.ajp.AjpNio2Protocol'
}
